<!doctype html><html lang=en-US><title>MJP Personal Website </title><meta charset=utf-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="initial-scale=1.0,width=device-width" name=viewport><meta content="Personal website of Matthew Piekenbrock - includes research, background, resume/CV, and work experience." name=description><meta content="Matthew Piekenbrock" name=author><link href=https://mattpiekenbrock.com/posts/lanczos2/ rel=canonical><link href=/css/tw_styles.css rel=stylesheet><link href=/css/overrides.css rel=stylesheet></head><nav class="navbar top-0 left-0 w-full bg-white border-b shadow-sm" id=navbar><div class="flex flex-row items-center p-3 justify-start md:justify-start"><div class="flex align-middle" id=brand><a class="mr-4 text-lg font-semibold" href=/>Home</a></div><div class="flex hidden overflow-hidden space-x-4 align-middle grow md:flex" id=navlinks><a class="text-lg text-gray-600 hover:text-gray-900" href=/cv>CV</a><a class="text-lg text-gray-600 hover:text-gray-900" href=/projects>Projects</a><a class="text-lg text-gray-600 hover:text-gray-900" href="https://scholar.google.com/citations?hl=en&user=2lPQ3UQAAAAJ">Publications</a><a class="text-lg text-gray-600 hover:text-gray-900" href=/software>Code</a><a class="text-lg text-gray-600 hover:text-gray-900" href=/blog>Blog</a></div><div class="flex items-center mr-2 align-middle md:hidden hover:cursor-pointer"><div class="inline-flex justify-center items-center text-gray-400 rounded-md button place-end" style="hover:text-white hover:bg-gray-700 focus:outline-none" id=menu-btn type=button><svg class="w-6 h-6" viewbox="0 0 24 24" fill=none stroke=currentColor><path d="M4 6h16M4 12h16M4 18h16" stroke-linecap=round stroke-linejoin=round stroke-width=2></path></svg></div></div></div><div class="flex hidden flex-col px-2 pt-0 pb-2 space-y-1 border divide-y md:hidden" id=mobile-menu style=sm:px-3><a class="block w-full text-lg text-gray-600 rounded-sm hover:text-gray-900" href=/cv>   CV</a><a class="block w-full text-lg text-gray-600 rounded-sm hover:text-gray-900" href=/projects>   Projects</a><a class="block w-full text-lg text-gray-600 rounded-sm hover:text-gray-900" href="https://scholar.google.com/citations?hl=en&user=2lPQ3UQAAAAJ">   Publications</a><a class="block w-full text-lg text-gray-600 rounded-sm hover:text-gray-900" href=/software>   Code</a><a class="block w-full text-lg text-gray-600 rounded-sm hover:text-gray-900" href=/blog>   Blog</a></div></nav><body style="min-width: 428px !important;"><main class="grid grid-cols-1 md:grid-cols-12"><aside class="hidden md:block md:col-span-2"></aside><article class="mx-auto w-full text-justify md:col-span-8 px-4" style="max-width: 85ch;"><div class="prose prose-base prose-article" style="font-family: 'et-book';"><h1 class="my-1 text-center">The Lanczos Algorithm</h1><div class="text-sm italic text-center">By: Matt Piekenbrock,    Posted: Oct 15, 2023,     ~3 min read</div><div class=text-center><div class="space-x-1 align-middle"><span class="px-1 py-0 text-sm rounded-sm border">math</span><span class="px-1 py-0 text-sm rounded-sm border">linear algebra</span><span class="px-1 py-0 text-sm rounded-sm border">high performance computing</span></div></div><hr class=m-1><div class="pt-4 w-full" id=page_content><h2 id=beating-the-complexity-bounds tabindex=-1>Beating the complexity bounds</h2><p>Elegant and as theoretically founded as the Lanczos method may be, is it efficient in practice?<p>Let’s start by establishing a baseline on its complexity:<div style="background-color: #efefef;" class=theorem id=thm-line><p><span class=theorem-title><strong>Theorem 1 (Parlett 1994)</strong></span> Given a symmetric rank-<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>r</mi></mrow><annotation encoding=application/x-tex>r</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>r</span></span></span></span> matrix <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>A</mi><mo>∈</mo><msup><mi mathvariant=double-struck>R</mi><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow></msup></mrow><annotation encoding=application/x-tex>A \in \mathbb{R}^{n \times n}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7224em;vertical-align:-0.0391em;></span><span class="mord mathnormal">A</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.7713em;></span><span class=mord><span class="mord mathbb">R</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.7713em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span> whose operator <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>x</mi><mo>↦</mo><mi>A</mi><mi>x</mi></mrow><annotation encoding=application/x-tex>x \mapsto A x</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.522em;vertical-align:-0.011em;></span><span class="mord mathnormal">x</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>↦</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal">A</span><span class="mord mathnormal">x</span></span></span></span> requires <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>O</mi><mo stretchy=false>(</mo><mi>η</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>O(\eta)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>O</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.03588em;>η</span><span class=mclose>)</span></span></span></span> time and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>O</mi><mo stretchy=false>(</mo><mi>ν</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>O(\nu)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>O</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.06366em;>ν</span><span class=mclose>)</span></span></span></span> space, the Lanczos method computes <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=normal>Λ</mi><mo stretchy=false>(</mo><mi>A</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\Lambda(A)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord>Λ</span><span class=mopen>(</span><span class="mord mathnormal">A</span><span class=mclose>)</span></span></span></span> in <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>O</mi><mo stretchy=false>(</mo><mi>max</mi><mo>⁡</mo><mo stretchy=false>{</mo><mi>η</mi><mo separator=true>,</mo><mi>n</mi><mo stretchy=false>}</mo><mo>⋅</mo><mi>r</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>O(\max\{\eta, n\}\cdot r)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>O</span><span class=mopen>(</span><span class=mop>max</span><span class=mopen>{</span><span class="mord mathnormal" style=margin-right:0.03588em;>η</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal">n</span><span class=mclose>}</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>⋅</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>r</span><span class=mclose>)</span></span></span></span> time and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>O</mi><mo stretchy=false>(</mo><mi>max</mi><mo>⁡</mo><mo stretchy=false>{</mo><mi>ν</mi><mo separator=true>,</mo><mi>n</mi><mo stretchy=false>}</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>O(\max\{\nu, n\})</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>O</span><span class=mopen>(</span><span class=mop>max</span><span class=mopen>{</span><span class="mord mathnormal" style=margin-right:0.06366em;>ν</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal">n</span><span class=mclose>})</span></span></span></span> space, when computation is done in exact arithmetic</div><p>As its clear from the theorem, if we specialize it such that <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>r</mi><mo>=</mo><mi>n</mi></mrow><annotation encoding=application/x-tex>r = n</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>r</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">n</span></span></span></span> and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>η</mi><mo>=</mo><mi>ν</mi><mo>=</mo><mi>n</mi></mrow><annotation encoding=application/x-tex>\eta = \nu = n</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.625em;vertical-align:-0.1944em;></span><span class="mord mathnormal" style=margin-right:0.03588em;>η</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal" style=margin-right:0.06366em;>ν</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">n</span></span></span></span>, then the Lanczos method requires just <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>O</mi><mo stretchy=false>(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>O(n^2)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.0641em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>O</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">n</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8141em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> time and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>O</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>O(n)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>O</span><span class=mopen>(</span><span class="mord mathnormal">n</span><span class=mclose>)</span></span></span></span> space to execute. In other words, the Lanczos method drops <em>both</em> the time and space complexity[^4] of obtaining spectral information by <strong>order of magnitude</strong> over similar eigen-algorithms that decompose <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>A</mi></mrow><annotation encoding=application/x-tex>A</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal">A</span></span></span></span> directly.<p>To see why this is true, note that a symmetric tridiagonal matrix is fully characterized by its diagonal and subdiagonal terms, which requires just <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>O</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>O(n)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>O</span><span class=mopen>(</span><span class="mord mathnormal">n</span><span class=mclose>)</span></span></span></span> space. If we assume that <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>v</mi><mo>↦</mo><mi>A</mi><mi>v</mi><mo>∼</mo><mi>O</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>v \mapsto Av \sim O(n)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.522em;vertical-align:-0.011em;></span><span class="mord mathnormal" style=margin-right:0.03588em;>v</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>↦</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style=margin-right:0.03588em;>v</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>∼</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>O</span><span class=mopen>(</span><span class="mord mathnormal">n</span><span class=mclose>)</span></span></span></span>, then carrying out the recurrence clearly takes at most <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>O</mi><mo stretchy=false>(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>O(n^2)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.0641em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>O</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">n</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8141em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> time, since there are most <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">n</span></span></span></span> such vectors <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo stretchy=false>{</mo><msub><mi>q</mi><mi>i</mi></msub><msubsup><mo stretchy=false>}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup></mrow><annotation encoding=application/x-tex>\{q_i\}_{i=1}^n</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.0087em;vertical-align:-0.2587em;></span><span class=mopen>{</span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>q</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mclose><span class=mclose>}</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.6644em;><span style=top:-2.4413em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2587em;><span></span></span></span></span></span></span></span></span></span> to generate!<p>Now, if we need to store all of <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>Y</mi></mrow><annotation encoding=application/x-tex>Y</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.22222em;>Y</span></span></span></span> or <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>Q</mi></mrow><annotation encoding=application/x-tex>Q</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8778em;vertical-align:-0.1944em;></span><span class="mord mathnormal">Q</span></span></span></span> explicitly, we clearly need <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>O</mi><mo stretchy=false>(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>O(n^2)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.0641em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>O</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">n</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8141em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> space to do so. However, if we only need the eigen-<em>values</em> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=normal>Λ</mi><mo stretchy=false>(</mo><mi>A</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\Lambda(A)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord>Λ</span><span class=mopen>(</span><span class="mord mathnormal">A</span><span class=mclose>)</span></span></span></span> (and not their eigen-vectors <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>U</mi></mrow><annotation encoding=application/x-tex>U</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.10903em;>U</span></span></span></span>), then we may execute the recurrence keeping at most three vectors <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo stretchy=false>{</mo><msub><mi>q</mi><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator=true>,</mo><msub><mi>q</mi><mi>j</mi></msub><mo separator=true>,</mo><msub><mi>q</mi><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=false>}</mo></mrow><annotation encoding=application/x-tex>\{q_{j-1}, q_{j}, q_{j+1}\}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.0361em;vertical-align:-0.2861em;></span><span class=mopen>{</span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>q</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.05724em;>j</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>q</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.05724em;>j</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>q</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.05724em;>j</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mclose>}</span></span></span></span> in memory at any given time. Since each of these is <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>O</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>O(n)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>O</span><span class=mopen>(</span><span class="mord mathnormal">n</span><span class=mclose>)</span></span></span></span> is size, the claim of <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>O</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>O(n)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>O</span><span class=mopen>(</span><span class="mord mathnormal">n</span><span class=mclose>)</span></span></span></span> space is justified!</div><br></div></article><aside class="hidden md:block md:col-span-2"><ol class="sticky top-2 space-1-2 text-neutral-600 px-[5px] dark:text-neutral-200 hover:text-gray-600" id=toc><li><a href=#beating-the-complexity-bounds>Beating the complexity bounds</a></ol></aside></main><script integrity="sha512-NNb5TgmE+7PHedvAWwPKZ/ukCGJciTHZ23ghPriEeEfcGySDBm9zIrjaXp/WNAUcVYhi5XhJ1rHveDKR35CInw==" crossorigin referrerpolicy=no-referrer src=https://cdnjs.cloudflare.com/ajax/libs/simple-scrollspy/2.4.1/simple-scrollspy.min.js></script><script>const menuBtn = document.getElementById('menu-btn');
const mobileMenu = document.getElementById('mobile-menu');
menuBtn.addEventListener('click', () => {
	mobileMenu.classList.toggle('hidden');
	mobileMenu.classList.toggle('block');
});
document.addEventListener('DOMContentLoaded', function() {
	var cards = document.querySelectorAll('.cursor-context-menu');
	cards.forEach(function(card) {
		card.addEventListener('click', function() {
			console.log(this);
			var parent = this.parentElement;
			parent.querySelector(".accordion-header").classList.toggle("active");
			parent.querySelector(".text-ellipsis").classList.toggle("hidden");
			parent.querySelector(".accordion-body").classList.toggle("hidden");
			parent.querySelector('svg').classList.toggle("hidden");
		});
	});
});</script><script>window.si = window.si || function () { (window.siq = window.siq || []).push(arguments); };</script><script defer src=/_vercel/speed-insights/script.js></script><script defer src=/_vercel/insights/script.js></script><link href=/css/fonts.css property=stylesheet rel=stylesheet><link href=/css/katex.min.css property=stylesheet rel=stylesheet><link href=/css/github.min.css property=stylesheet rel=stylesheet><link href=/css/prism-one-light.css property=stylesheet rel=stylesheet><script async crossorigin issue-term=pathname repo=peekxc/blog_comments src=https://utteranc.es/client.js theme=preferred-color-scheme></script><script src=https://cdn.bokeh.org/bokeh/release/bokeh-3.2.0.min.js></script><script>window.onload = function () {
	navbar = document.querySelector("#navbar");
	var scrollspy = scrollSpy("#toc", {
		sectionClass: ".scrollspy", 
		menuActiveTarget: "li > a", 
		offset: navbar.getBoundingClientRect().height, 
		smoothscroll: true,
		//- scrollContainer: "article"
		//- onActive: (el) => {
		//- 	console.log('run "onActive"...', el)
		//- }
	})
}</script><footer class="sticky bottom-0 mt-auto w-full text-center bg-gray-100 border footer prose prose-sm top-[100vh]"><span>© Matt Piekenbrock 2024. </span>Proudly built with <a href=https://www.11ty.dev/>11ty</a> + <a href=https://quarto.org/>Quarto</a>.</footer>